# Домашнее задание к занятию "11.02 Микросервисы: принципы"

## Задача 1: API Gateway
|Вопрос|RPC|REST|GraphQL|Событийная модель
|---|---|---|---|---|
|Детали реализации недоступны другим сервисам|+|+|+|+|
|Потребители не ограничены одним стеком|+|+|+|+|
|Простота использования|+|+|-|-|
|Возможность получить несколько ресурсов одним запросом|-|-|+|+|
|Хорошая поддержка инфраструктурными инструментами|-|+|+|-|
|Текстовый формат данных JSON, XML|-|+|+|+|
|Вариативность расширения моделей|-|+-|-|+|
|Всегда возможно описать модель в терминах протокола HTTP|+|-|+|+|

**Решение должно соответствовать следующим требованиям:**

1. Маршрутизация запросов к нужному сервису на основе конфигурации
2. Возможность проверки аутентификационной информации в запросах
3. Обеспечение терминации HTTPS
___

Проанализировав полученные требования, будет уместным использовать REST API. Он прост в использовании, поддерживает HTTPS, имеет возможность настройки как HTTP Basic аутентификации, так и OAuth. Маршрутизация запросов к нужному сервису достигается поднятием группы API Gateway, каждая из которых будет отвечать за определенный маршрут.
___

## Задача 2: Брокер сообщений

### Таблица сравнения брокеров сообщений

|     |RabbitMQ|ActiveMQ|SwiftMQ|Apollo|Результат
|---|---|---|---|---|---|
|Подписка на сообщения|+|+|+|+|Равнозначно|
|Однонаправленная, широковещательная, групповая передача данных|Все типы|Однонаправленный и широковещательный|Однонаправленный|Однонаправленный и широковещательный|Преимущество RabbitMQ
|Упорядоченная доставка сообщений|+|+|-|-|RabbitMQ и ActiveMQ лидируют|
|Гарантированная доставка сообщений|+|+|+|+|Равнозначно|
|Кластеризация|+|+|+|-|Apollo отстает|
|Масштабируемость|+|+|+|+|Равнозначно|
|Контроль доступа|+|+|+|+|Равнозначно|

Проанализировав предоставленную таблицу, явным фаворитом оказывается RabbitMQ. Он поддерживает кластеризацию/масштабируемость, позволяет хранить сообщения на диске (для этого необходимо в Publisher выставить delivery_mode=2), имеет возможность разделения прав и имеет высокую скорость работы (см. ниже). 

Из всех предоставленных брокеров, наиболее высокая сокрость у RabbitMQ, результаты тестов, найденные в открытом источнике представлю ниже:
|Условие|2000000|200000|20000|2000|
|---|---|---|---|---|
|Брокер|1kb|1kb|10kb|10kb|
|RabbitMQ|4606 сообщ/c|5720 сообщ/c|5115 сообщ/c|3145 сообщ/c|
